5.4已免费开放




5.3更新了啥忘记了，就不写了




## 版本 5.2 (最新版本)

### 🚀 核心架构升级 (AppOpt 2.1.0)
1. **高级调度策略支持**
   - 新增 `SchedPolicyType` 枚举，全面支持 FIFO (实时先入先出)、RR (实时轮转)、UClamp (性能钳位) 和 Nice (优先级) 调度策略
   - 支持针对特定线程设置实时优先级和调度类，大幅降低关键线程延迟
   - 引入 `ThreadTracker` 结构体，实现更精细的线程级性能追踪

2. **性能与稳定性优化**
   - 新增日志级别控制系统 (`LOG_LEVEL_*`)，支持通过环境变量动态调整日志详细程度，减少IO开销
   - 引入 `MIN_THREAD_LIFETIME` (5秒) 和 `MIN_STRATEGY_CHANGE_INTERVAL` (3秒) 机制，防止频繁策略切换导致的抖动
   - 优化锁机制和系统调用，大幅降低调度器自身的CPU占用
   - 增加 `PROC_CACHE_TIMEOUT` 状态缓存，减少重复的进程状态读取

### 📱 平台适配与主控增强
1. **多平台智能识别**
   - 新增 `PlatformType` 枚举和识别逻辑，区分 Qualcomm 和 MediaTek 平台，为特定平台优化奠定基础
   - 优化应用状态检查机制，引入 `APP_CHECK_INTERVAL` 和 `SELECT_TIMEOUT_SEC`，提升前台应用切换的响应速度
   - 增强特殊应用配置结构，支持更细粒度的每个应用独立CPU策略控制

### ⚙️ 配置文件调优 (SM8650)
1. **极致性能释放**
   - 全面解锁CPU频率上限：
     - 小核 (Cluster 0): 1.24GHz -> 1.46GHz
     - 超大核 (Cluster 3): 1.59GHz -> 2.11GHz
     - 大核 (Cluster 2): 1.40GHz -> 1.61GHz
   - 优化 Boost 策略，针对不同核心群集设置更合理的负向Boost值，平衡性能与功耗

2. **精细化调度参数**
   - 引入 `hispeed_freq` 参数，设定高效能频率点，提升突发负载响应
   - 调整 `target_loads` 参数，采用更复杂的负载-频率映射关系，优化能效比

---

## 版本 5.1

### 🚀 重大新增功能
1. **智能CPU配置生成系统**
   - 新增 JSON/ 目录，包含智能CPU配置生成工具
   - 新增 cpu.sh 脚本 (267行)，实现高级芯片型号检测算法
   - 新增 setup 二进制工具，用于自动化配置文件生成
   - 支持 Qualcomm (SM/SDM/MSM)、MediaTek (MT/Dimensity)、Exynos 等主流芯片平台

2. **芯片检测算法全面升级**
   - 实现 extract_chip_model_like_c() 函数，与C代码逻辑完全一致
   - 支持 OnePlus 特殊处理 (OPSM/CPHSM 模式)
   - 支持 Dimensity 系列自动转换为 MT 格式
   - 支持大小写混合的芯片型号识别 (如 mt6895z_a)

3. **配置文件版本管理优化**
   - 默认配置版本从 "1.0" 升级到 "5.1"
   - 增强版本兼容性检查和配置迁移能力

### ⚡ 功能增强
1. **源码架构优化**
   - 移除版权声明头部注释，精简代码结构
   - 优化 CpuCtlGroup 结构体中 shares 字段范围 (2-1024)
   - 改进代码可读性和维护性

2. **CPU控制组参数调整**
   - 将 cpu.shares 最大值从 262144 调整为 1024，提高系统稳定性
   - 优化CPU份额分配算法，减少资源竞争

### 🔧 工具链完善
1. **自动化配置生成**
   - JSON/cpu.sh 支持多种系统属性读取方式
   - 支持 /system/build.prop、/vendor/build.prop 等多个配置源
   - 实现智能频率检测和调速器参数生成

2. **跨平台兼容性**
   - 支持更多芯片厂商和型号识别
   - 增强对不同Android版本的兼容性

---

## 版本 5.0

### 🚀 重大新增功能
1. **CPU控制组(cpuctl)支持**
   - 新增 CpuCtlGroup 和 CpuCtlSettings 结构体
   - 支持 uclamp_min/uclamp_max (0-100百分比) - 精确控制CPU利用率上下限
   - 支持 latency_sensitive (0/1) - 延迟敏感任务优先级控制
   - 支持 cpu.shares (2-262144) - CPU时间片分配权重
   - 针对 background、system-background、foreground、top-app 四个组进行精细控制

2. **企业级日志管理系统**
   - 新增自动日志备份功能 (backup_and_clear_log)
   - 智能清理旧日志备份 (cleanup_old_logs)
   - 日志备份目录: /data/adb/modules/muronggameopt/config/log_backups
   - 防止日志文件过大影响系统性能

3. **配置版本管理系统**
   - 新增 config_version 全局变量和版本控制
   - 新增 load_config_version() 函数
   - 支持配置文件版本兼容性检查

4. **CPU检测算法全面升级**
   - 新增 extract_chip_model() 函数，支持更精确的芯片型号提取
   - 新增 is_numeric() 函数，用于数字字符串验证
   - 大幅改进CPU型号检测准确率和兼容性

### ⚡ 功能增强
1. **特殊应用设置架构重构**
   - 特殊应用配置中新增完整的 cpuctl 设置支持
   - 支持应用级别的CPU控制组参数精细调整
   - 将设置应用拆分为三个独立函数提高模块化:
     - apply_special_app_cpu_settings() - CPU频率和调速器设置
     - apply_special_app_ddr_settings() - DDR内存频率设置  
     - apply_special_app_cpuset_settings() - CPU核心分配设置

2. **JSON配置解析能力扩展**
   - 在 load_mode_settings_json() 中新增完整的 cpuctl 配置解析
   - 支持四个控制组的独立配置和参数验证
   - 增强配置文件容错性和错误处理

3. **系统启动流程优化**
   - 主函数开始时自动执行日志备份和清理
   - CPU型号检测后立即加载配置版本信息
   - 改进前台应用检测的过滤逻辑和性能

### 🔧 代码架构改进
1. **新增关键宏定义**
   - LOG_BACKUP_DIR: 日志备份目录路径
   - MAX_VERSION_LEN: 最大版本号长度限制
   - INOTIFY_EVENT_SIZE 和 INOTIFY_BUF_LEN: inotify事件处理缓冲区

2. **函数声明和代码组织完善**
   - 新增多个核心函数的原型声明
   - 改进整体代码结构和可维护性

---

## 版本 4.9

### 🎯 核心新功能
1. **实时文件系统监控(inotify)**
   - 完整的 inotify 初始化和事件处理系统
   - 实时监控模式文件 (MODE_FILE) 变化
   - 实时监控CPU配置文件变化
   - 实时监控配置目录变化
   - 大幅减少轮询开销，提升系统响应速度

2. **事件驱动架构**
   - 新增 handle_inotify_events() 核心事件处理函数
   - 支持配置文件变化的实时响应
   - 使用 select() 进行高效的非阻塞事件监听
   - 从轮询模式升级为事件驱动模式

3. **配置版本管理**
   - 新增 load_config_version() 函数
   - 支持动态配置版本加载和兼容性检查

### 🔍 应用检测优化
1. **智能前台应用过滤**
   - 新增应用名称有效性验证机制
   - 过滤长度过短的无效应用名称 (< 3字符)
   - 过滤包含空格的异常应用名称
   - 扩展系统应用忽略列表，提高检测准确率

2. **特殊应用配置增强**
   - 在 load_special_apps_cache() 中新增 cpuset 设置解析
   - 支持 background、systembackground、foreground、topapp 的独立 cpuset 配置
   - 提升特殊应用优化的精细度

### 🚀 性能和稳定性提升
1. **主循环架构升级**
   - 使用 select() 和 fd_set 进行高效事件驱动处理
   - 设置1秒超时的智能事件监听
   - 大幅优化应用切换检测逻辑和响应速度

2. **代码安全性增强**
   - 新增 safe_strncpy() 函数，彻底防止缓冲区溢出
   - 新增 file_exists() 函数，统一文件存在性检查
   - 增强 inotify 初始化和文件监听的错误处理

3. **系统资源优化**
   - 事件驱动模式显著减少CPU占用
   - 优化文件变化检测机制，减少不必要的IO操作

---

## 版本对比总结

### 🔄 从 4.8 到 4.9 的技术跃升
- **架构革新**: 从轮询模式升级为事件驱动架构
- **性能提升**: 引入 inotify 文件系统监控，大幅减少系统开销
- **稳定性**: 改进前台应用检测和过滤机制
- **安全性**: 增强代码安全性和错误处理能力

### 🚀 从 4.9 到 5.0 的企业级升级
- **功能完善**: 新增完整的 CPU 控制组(cpuctl)支持
- **管理升级**: 实现企业级日志管理和备份系统
- **算法优化**: 全面升级CPU检测算法和兼容性
- **架构重构**: 完善配置版本管理和模块化设计

### 📈 技术架构演进路径
- **4.8**: 基础调度功能，轮询检测模式
- **4.9**: 事件驱动架构，实时响应机制  
- **5.0**: 企业级特性，精细化控制系统

每个版本都在前一版本的坚实基础上进行了显著的功能增强和性能优化，逐步构建了一个功能完整、性能卓越、稳定可靠的Android设备智能调度系统。

---

4.8：修复录屏时无法正确识别前台应用的bug，优化SM8650.json中均衡和性能模式，软件更新打开自动检测cpu型号，点击检测频率列表，根据SM8650创建一个当前处理器的模板。







4.7：
### 主要功能升级对比

| **功能模块**       | **旧版本实现**                     | **新版本增强**                     |
|--------------------|----------------------------------|----------------------------------|
| **CPU模型检测**     | 仅支持SM8650硬编码               | 动态检测多型号(SM8550/SM8650/SM8750) |
| **CPU集群识别**     | 简单按policy编号识别             | 频率分组智能识别多级集群拓扑        |
| **调速器支持**      | 仅支持walt调速器                 | 通用调速器框架(支持schedutil等)    |
| **特殊应用优化**    | 仅支持3个参数                    | 支持动态参数覆盖+详细日志记录      |
| **权限管理**        | 临时修改权限                     | 系统级remount+持久权限解决方案     |
| **DDR频率控制**     | 硬编码频率值                     | 动态频率计算(ddr_min*1.2等)        |
| **配置文件管理**    | 单一配置文件                     | 按CPU型号动态加载配置              |
| **错误处理**        | 基础错误检测                     | 增强型错误处理+详细日志记录        |

**核心架构升级**
```markdown
1. 💡 动态CPU拓扑识别
   - 新增频率分组算法自动识别多级集群
   - 支持Big.Little架构智能策略分配
   - 日志记录完整拓扑结构

2. 🚀 通用调速器框架
   - 解耦walt依赖，支持schedutil/cpufreq等
   - 动态参数加载系统（支持20+参数）
   - 自动检测调速器兼容性

3. 📦 模块化配置系统
   + 按CPU型号加载配置(SM8550.json等)
   + 特殊应用独立配置文件机制
   + 配置热重载检测（文件修改时间戳）
```

**性能优化增强**
```markdown
4. ⚡ DDR频率动态计算
   - 支持相对值设置 (ddr_min*1.2)
   - 多DDR控制器并行控制
   - 硬件极限频率自动检测

5. 🎮 特殊应用深度优化
   + 参数覆盖系统（可覆盖任何配置项）
   + 多维度设置缓存（32个应用配置）
   + 详细应用优化日志记录
```

**稳定性提升**
```markdown
6. 🔒 增强权限管理系统
   - 启动时自动remount /sys
   - 策略文件权限持久化方案
   - 双重写入保障机制

7. 📊 智能日志系统
   + 自动日志轮转（>500KB清理）
   + 错误分级记录机制
   + 带时间戳的详细操作记录
```

**兼容性扩展**
```markdown
8. 📱 多设备支持
   - 高通SM8xxx全系支持
   - 动态fallback机制（未知CPU→default）
   - 构建属性多路径检测
```

**问题修复**
```markdown
9. 🐛 关键问题修复
   - 修复JSON解析内存泄漏
   - 解决特殊应用min_freq数组越界
   - 优化前台应用识别准确率
   - 修复DDR控制器路径检测逻辑
```

---

### 升级说明建议
```markdown
⚠️ **配置迁移注意**
1. 配置文件路径变更：
   Old: `/data/adb/modules/muronggameopt/bin/activity_diaodu.json`
   New: `/data/adb/modules/muronggameopt/bin/cpu/[CPU型号].json`

2. 特殊应用配置格式升级：
   - 新增动态参数支持
   - 需添加cluster映射关系
   - 支持相对频率值设置





4.6：# 慕容调度 4.6 - 架构升级与性能突破

## 核心技术革新
1. **内核级架构重构**
   - Shell → C语言全面迁移
   - 配置系统升级为JSON结构化格式
   - 内存占用减少80% (20MB → 4.4MB)

2. **性能飞跃**
   - 执行效率提升300%
   - 前台应用检测响应 <50ms
   - 配置缓存机制减少文件IO开销

3. **智能容错系统**
   - 错误模式自动回退至均衡模式
   - 三重处理器校验（非SM8650/8Gen3立即退出）

## 关键功能升级
4. **动态频率引擎**
   ```json
   "ddr": {
     "max_freq": "ddr_min*3.824499"
   }

5. **特殊应用优化**
   ```json
   {
     "package": "com.oplus.camera",
     "boost": 0,
     "min_freq": [1344000,1920000,1920000,1939200]
   }
   ```

6. **实时配置系统**
   - 文件修改自动检测
   - 配置热更新（无需重启服务）
   - 变更缓存即时生效

## 用户体验优化
7. **刷机流程增强**
   - 音量键选择是否保留插帧功耗
   - 默认禁用冲突进程oiface
   - 新手友好型刷入向导

## 性能实测对比
| 指标               | 4.5     |   4.6   |  提升  |
|--------------|-------|-------|-------|
| 内存占用        | 20MB |4.4MB|↓78%|
| 策略应用延迟 | 150ms| 35ms  | ↓76%|




4.5：线程跟随上游更新，优化王者帧率和功耗，优化省电模式流畅度，优化其他模式游戏帧率。



4.4：线程跟随上游更新，已适配线程全部优化，新增适配无畏契约线程，优化日用功耗，优化王者帧率和功耗，优化全模式功耗和帧率



4.3：线程跟随上游更新，优化日常应用线程，优化全模式功耗



4.2:跟随上游更新，优化更改日常应用线程，添加狼人杀（网易），修复软件进入慢的bug，优化日用和游戏功耗，优化游戏帧率




4.1：优化帧率和功耗表现，跟随上游更新线程脚本




4.0：优化帧率和功耗表现，跟随上游更新线程脚本





3.9：优化功耗表现，自动禁用官方线程




3.8：优化功耗表现，优化流畅度和帧率





3.7：优化功耗表现，优化日用流畅度，王者极致画质4.4w，AVG120.7帧，和平钢枪7w，AVG119.3帧。





3.6：优化应用，系统进程添加品牌检测，非ColorOS看不到gameopt，urcc，oiface这些进程。





3.5：优化线程执行逻辑，修复软件线程进程无法执行






3.4：优化均衡模式，更新软件，线程管理器支持自动适配路径






3.3：优化省电，均衡模式功耗，内置线程添加一些日常应用






3.2：内置线程更改为二改SutoLiu线程优化模块，优化全模式帧率和功耗表现。






3.1：修复刷入失败的问题，优化线程脚本，更改线程范围搜索：Thread-[0-9]|Thread-1[0-5]=7更改为#Thread-0[0-9]=7
Thread-1[0-5]=7，[]里面只能写个位数。





3.0：优化线程脚本，更改线程范围搜索：Thread-{0-15}=7改为Thread-1[5-9]|Thread-2[0-5]=7，[]里面只能写个位数。优化日用流畅度






慕容调度2.9更新日志：优化全模式功耗，优化调度线程脚本，开放自定义线程修改。






1.3：尝试修复王者荣耀功耗爆炸的问题
更新时间：2025年3月16日12.42







1.2：尝试修复王者荣耀功耗高的问题

更新时间：2025年3月16日0点





ColorOS官调优化（仅8GEN3）1.1：
2025年3月14号02.55更新日志：
1.添加风驰内核。
1.优化service.sh脚本，优化风驰脚本，使其功耗更低。
2.添加检测前台应用替换scx，使其支持更多游戏
3.增加挂载一加ACE5的vendor_dlkm/lib/modules/oplus_bsp_sched_ext.ko文件。
4.降低王者功耗并优化帧率。

支持的游戏：王者，和平，cfm，lolm，星铁，原神，永劫无间，燕云十六声，CODM，三角洲，鸣潮






2.8：优化日用（省电），优化王者荣耀（均衡），和平精英（性能）帧率和功耗，优化极速调度释放（请佩戴散热器使用），优化执行脚本。




2.7：优化全模式功耗和帧率





2.6：优化省电模式功耗。





2.5：优化省电模式功耗，优化王者和平线程分配，优化日用流畅度，优化均衡模式，性能模式帧率和功耗。





2.4：优化调度线程执行脚本，优化省电模式功耗，优化均衡模式帧率和功耗，优化性能模式（和平）帧率。





2.3：优化省电模式流畅度和功耗，更新软件内置线程应用显示





2.2：优化省电模式功耗，优化线程执行脚本




2.1：更改执行脚本，仅在切换应用时执行调度，优化全模式功耗表现。




1.9：优化线程，优化全模式功耗和帧率表现



1.8：优化王者荣耀线程放置，优化全模式游戏帧率，不在扣功耗。




1.7：优化线程执行条件




1.6：优化王者荣耀功耗，优化lolm帧率，优化省电和均衡模式，线程优化代码，执行条件为3秒内前台应用不同则执行一次，可预防跟官方线程抢夺造成的卡顿和解决线程负载异常的问题




1.5：修复thread.txt错误的包名




1.4：修复刷入脚本无法正确写入配置的问题




1.3：优化王者荣耀的线程和均衡模式功耗




1.2：优化王者荣耀的线程，更新软件。




慕容调度1.1：重构线程，支持之前慕容线程的所有游戏，并新适配燕云十六声，优化游戏功耗。




由于我使用kernelsu next的Gki内核导致的官方线程失效，所以模块直接内置线程（使用scene接管调度请勿打开核心分配）并更名为慕容调度。




因停更除8GEN3以外的处理器，所以重命名，重新更改版本号，只有ColorOS15的8GEN3才可以更新，如果没有达到这个条件，请勿更新，更新出现不开机等问题，不做售后。




8.4/3.5：优化全模式功耗。



8.3/3.4：移除刷入脚本fas选择，以后只有省电模式游戏时才会开启fas，优化全模式功耗表现，更新日期：2025年1月05日05.44



8.2/3.3：优化省电模式功耗，优化均衡和性能模式调度释放。
更新日期：2025年01月02日00.44



8.1/3.2：修复8Elite调度失效的问题，优化省电和均衡模式功耗。
更新日期：2024年12月31日12.00




8.0/3.1：修复错误的参数导致某些核心无法正确切换调速器，导致的调度无法生效的问题。
更新日期：2024年12月28日03.20




7.9/3.0：取消频率限制，使用cat命令自动获取并设置最大最小频率，添加检测是否支持walt调速器，不支持自动切换schedutil调速器，省电均衡性能模式功耗优化，流畅度帧率优化，降低性能模式的性能释放。
更新日期：2024年12月28日01.30




2.9：优化省电模式流畅度和均衡模式游戏功耗和帧率。
7.8：均衡模式王者超越风驰游戏内核！！！省电模式日用流畅度大幅度提升！
更新日期：2024年12月27日05.54




7.7/2.8：重构调度代码，执行效率更高，优化省电模式和均衡模式。
更新日期：2024年12月25日17.50





7.6/2.7：优化省电和均衡模式功耗。更新日期：2024年12月24日14.00




7.5/2.6：优化省电模式功耗，优化性能/极速模式调度释放，省电模式只适合日用，均衡模式功耗和帧率达到平衡，性能和极速模式功耗会很高，但帧率会很稳。
更新日期：2024年12月23日11.00




7.4/2.5：优化全模式功耗，调度循环时间更改为30秒。
更新日期：2024年12月21日17.00



7.3/2.4：优化省电/均衡/性能/极速模式功耗，流畅度和帧率



7.2/2.3：修复均衡模式参数错误



7.1/2.2：ddr频率调整为百分比限制，自动检测ddr最大频率



7.0/2.1：重构调度代码，使其更美观，执行效率更高，优化省电/均衡/性能/极速模式，新增ddr频率调整，极速模式下ddr频率直接拉满。新增log超过500kb自动删除并重建。



6.9/2.0：优化省电/均衡模式，更新调度log显示信息，优化日用功耗和流畅度。



6.8/1.9：修复安装apk时的scene显示。



6.7/1.8：优化模块刷入脚本，优化安装软件后的scene显示。



6.6/1.7：修复更新日志乱码。



6.5/1.6：修复更新按钮更新失败。
